<html>
    <head><title>Shoutbox</title>
        <script type="text/javascript" src="http://localhost:8000/site_media/orbited/Orbited.js"></script>
        <script>
            Orbited.settings.port = 9000;
            Orbited.settings.hostname = "localhost";
            TCPSocket = Orbited.TCPSocket;
        </script>
        <script type="text/javascript" src="http://localhost:8000/site_media/orbited/protocols/stomp/stomp.js"></script>
        <script type="text/javascript" src="http://localhost:8000/site_media/script/jquery-1.4.2.min.js"></script>
        <script>
            var add_message = function(payload) {
                var message1 = payload.toString();
                message_div = document.createElement("div");
                message_div.innerHTML = message1;
                document.getElementById("messages").appendChild(message_div);
            };

            $(document).ready(function() {
                stomp = new STOMPClient();
                stomp.onopen = function() {
                    alert("opened");
                };
                stomp.onclose = function(c) {
                };
                stomp.onconnectedframe = function() {
                    stomp.subscribe("/shouts");
                };
                stomp.onerror = function(error) {
                    alert(error);
                };
                stomp.onmessageframe = function(frame) {
                    add_message(frame.body);
                };
                stomp.connect("127.0.0.1", 61613);
                alert("here");
            });
        </script>
    </head>
    <body>
        <div id="shoutbox">
            <input type="text" id="shout_text" /><br />
            <div><button id="send_shout">Shout</button></div>
        </div>
        <div id="messages"></div>
    </body>
</html>
